import 'package:flutter/material.dart';
import 'package:flutter_test/flutter_test.dart';
import 'package:kwriting/domain/domain.dart';
import 'package:kwriting/infra/infra.dart';

void main() {
  group('StrokeReducer', () {
    late IStrokeReducer strokeReducer;

    setUpAll(() {
      strokeReducer = StrokeReducer(maxPointsQuantity: 20);
    });

    test('reduces horizontal strokes', () {
      final strokesReduced = strokeReducer.reduce(horizontalStroke);
      expect(strokesReduced, const [
        Offset(4.814077, 47.642762),
        Offset(28.798981, 48.55495),
        Offset(38.010905, 47.558835),
        Offset(49.576872, 48.384759),
        Offset(56.525863, 47.373498),
        Offset(65.215228, 48.967807),
        Offset(78.928414, 49.09821),
        Offset(91.467464, 48.306773),
      ]);
    });

    test('reduces vertical strokes', () {
      final strokesReduced = strokeReducer.reduce(verticalStroke);
      expect(strokesReduced, const [
        Offset(4.814077, 47.642762),
        Offset(28.798981, 48.55495),
        Offset(38.010905, 47.558835),
        Offset(49.576872, 48.384759),
        Offset(56.525863, 47.373498),
        Offset(65.215228, 48.967807),
        Offset(78.928414, 49.09821),
        Offset(91.467464, 48.306773),
      ]);
    });
  });
}

const horizontalStroke = [
  Offset(4.814077, 47.642762),
  Offset(5.0354139, 47.642762),
  Offset(5.2597623, 47.67915),
  Offset(5.4780877, 47.642762),
  Offset(5.6001352, 47.622421),
  Offset(5.6927114, 47.515887),
  Offset(5.810093, 47.47676),
  Offset(6.69303, 47.182447),
  Offset(8.5493517, 47.642762),
  Offset(9.4621514, 47.642762),
  Offset(9.7422672, 47.642762),
  Offset(10.811783, 47.49837),
  Offset(10.956175, 47.642762),
  Offset(10.995303, 47.68189),
  Offset(10.906683, 47.784019),
  Offset(10.956175, 47.808765),
  Offset(11.160238, 47.910796),
  Offset(11.398849, 47.919433),
  Offset(11.620186, 47.974768),
  Offset(12.382831, 48.165429),
  Offset(13.498658, 47.974768),
  Offset(14.276228, 47.974768),
  Offset(14.817969, 47.974768),
  Offset(15.95487, 48.214464),
  Offset(16.434263, 47.974768),
  Offset(17.172958, 47.60542),
  Offset(23.021065, 47.706291),
  Offset(23.73838, 47.808765),
  Offset(24.748408, 47.953055),
  Offset(25.84718, 47.828226),
  Offset(26.726428, 47.974768),
  Offset(27.192376, 48.052426),
  Offset(27.668595, 48.178155),
  Offset(28.054449, 48.306773),
  Offset(28.798981, 48.55495),
  Offset(30.68373, 48.306773),
  Offset(31.540505, 48.306773),
  Offset(32.966372, 48.306773),
  Offset(34.475851, 48.416915),
  Offset(35.856574, 48.14077),
  Offset(36.788514, 47.954382),
  Offset(38.010905, 47.558835),
  Offset(39.010624, 47.808765),
  Offset(40.041775, 48.066553),
  Offset(41.102948, 47.823092),
  Offset(42.164675, 47.974768),
  Offset(43.903042, 48.223106),
  Offset(45.206256, 48.306773),
  Offset(46.978752, 48.306773),
  Offset(48.256898, 48.306773),
  Offset(49.576872, 48.384759),
  Offset(50.796813, 48.14077),
  Offset(51.216773, 48.056778),
  Offset(51.709625, 48.244573),
  Offset(52.124834, 48.14077),
  Offset(52.200752, 48.121791),
  Offset(52.214919, 47.993747),
  Offset(52.290837, 47.974768),
  Offset(52.863709, 47.83155),
  Offset(53.543994, 48.117986),
  Offset(54.116866, 47.974768),
  Offset(55.118013, 47.724481),
  Offset(56.525863, 47.373498),
  Offset(57.602922, 47.642762),
  Offset(57.842995, 47.702781),
  Offset(58.021957, 47.939771),
  Offset(58.266932, 47.974768),
  Offset(61.547142, 48.443369),
  Offset(57.3955, 47.590907),
  Offset(59.594954, 48.14077),
  Offset(59.855374, 48.205875),
  Offset(60.74563, 47.963426),
  Offset(60.922975, 48.14077),
  Offset(60.962102, 48.179898),
  Offset(60.883848, 48.267646),
  Offset(60.922975, 48.306773),
  Offset(61.042083, 48.425881),
  Offset(61.561182, 48.268412),
  Offset(61.752988, 48.306773),
  Offset(62.504014, 48.456978),
  Offset(63.137222, 48.708056),
  Offset(63.911023, 48.804781),
  Offset(65.215228, 48.967807),
  Offset(66.817826, 48.887431),
  Offset(68.061089, 48.638778),
  Offset(69.30781, 48.389434),
  Offset(72.254341, 48.649575),
  Offset(73.539177, 48.970784),
  Offset(73.773, 49.029239),
  Offset(78.928414, 49.09821),
  Offset(79.183267, 48.970784),
  Offset(79.25326, 48.935787),
  Offset(79.273352, 48.82376),
  Offset(79.34927, 48.804781),
  Offset(80.329633, 48.55969),
  Offset(85.026187, 48.804781),
  Offset(86.155379, 48.804781),
  Offset(86.433989, 48.804781),
  Offset(88.938368, 48.843837),
  Offset(88.977424, 48.804781),
  Offset(89.198761, 48.583444),
  Offset(88.625279, 48.645491),
  Offset(89.143426, 48.472776),
  Offset(89.34263, 48.406375),
  Offset(89.608234, 48.539177),
  Offset(89.807437, 48.472776),
  Offset(91.009863, 48.071967),
  Offset(89.545716, 48.520635),
  Offset(90.305445, 48.14077),
  Offset(90.687664, 47.949661),
  Offset(91.162719, 48.306773),
  Offset(91.467464, 48.306773),
];

const verticalStroke = [
  Offset(4.814077, 47.642762),
  Offset(5.0354139, 47.642762),
  Offset(5.2597623, 47.67915),
  Offset(5.4780877, 47.642762),
  Offset(5.6001352, 47.622421),
  Offset(5.6927114, 47.515887),
  Offset(5.810093, 47.47676),
  Offset(6.69303, 47.182447),
  Offset(8.5493517, 47.642762),
  Offset(9.4621514, 47.642762),
  Offset(9.7422672, 47.642762),
  Offset(10.811783, 47.49837),
  Offset(10.956175, 47.642762),
  Offset(10.995303, 47.68189),
  Offset(10.906683, 47.784019),
  Offset(10.956175, 47.808765),
  Offset(11.160238, 47.910796),
  Offset(11.398849, 47.919433),
  Offset(11.620186, 47.974768),
  Offset(12.382831, 48.165429),
  Offset(13.498658, 47.974768),
  Offset(14.276228, 47.974768),
  Offset(14.817969, 47.974768),
  Offset(15.95487, 48.214464),
  Offset(16.434263, 47.974768),
  Offset(17.172958, 47.60542),
  Offset(23.021065, 47.706291),
  Offset(23.73838, 47.808765),
  Offset(24.748408, 47.953055),
  Offset(25.84718, 47.828226),
  Offset(26.726428, 47.974768),
  Offset(27.192376, 48.052426),
  Offset(27.668595, 48.178155),
  Offset(28.054449, 48.306773),
  Offset(28.798981, 48.55495),
  Offset(30.68373, 48.306773),
  Offset(31.540505, 48.306773),
  Offset(32.966372, 48.306773),
  Offset(34.475851, 48.416915),
  Offset(35.856574, 48.14077),
  Offset(36.788514, 47.954382),
  Offset(38.010905, 47.558835),
  Offset(39.010624, 47.808765),
  Offset(40.041775, 48.066553),
  Offset(41.102948, 47.823092),
  Offset(42.164675, 47.974768),
  Offset(43.903042, 48.223106),
  Offset(45.206256, 48.306773),
  Offset(46.978752, 48.306773),
  Offset(48.256898, 48.306773),
  Offset(49.576872, 48.384759),
  Offset(50.796813, 48.14077),
  Offset(51.216773, 48.056778),
  Offset(51.709625, 48.244573),
  Offset(52.124834, 48.14077),
  Offset(52.200752, 48.121791),
  Offset(52.214919, 47.993747),
  Offset(52.290837, 47.974768),
  Offset(52.863709, 47.83155),
  Offset(53.543994, 48.117986),
  Offset(54.116866, 47.974768),
  Offset(55.118013, 47.724481),
  Offset(56.525863, 47.373498),
  Offset(57.602922, 47.642762),
  Offset(57.842995, 47.702781),
  Offset(58.021957, 47.939771),
  Offset(58.266932, 47.974768),
  Offset(61.547142, 48.443369),
  Offset(57.3955, 47.590907),
  Offset(59.594954, 48.14077),
  Offset(59.855374, 48.205875),
  Offset(60.74563, 47.963426),
  Offset(60.922975, 48.14077),
  Offset(60.962102, 48.179898),
  Offset(60.883848, 48.267646),
  Offset(60.922975, 48.306773),
  Offset(61.042083, 48.425881),
  Offset(61.561182, 48.268412),
  Offset(61.752988, 48.306773),
  Offset(62.504014, 48.456978),
  Offset(63.137222, 48.708056),
  Offset(63.911023, 48.804781),
  Offset(65.215228, 48.967807),
  Offset(66.817826, 48.887431),
  Offset(68.061089, 48.638778),
  Offset(69.30781, 48.389434),
  Offset(72.254341, 48.649575),
  Offset(73.539177, 48.970784),
  Offset(73.773, 49.029239),
  Offset(78.928414, 49.09821),
  Offset(79.183267, 48.970784),
  Offset(79.25326, 48.935787),
  Offset(79.273352, 48.82376),
  Offset(79.34927, 48.804781),
  Offset(80.329633, 48.55969),
  Offset(85.026187, 48.804781),
  Offset(86.155379, 48.804781),
  Offset(86.433989, 48.804781),
  Offset(88.938368, 48.843837),
  Offset(88.977424, 48.804781),
  Offset(89.198761, 48.583444),
  Offset(88.625279, 48.645491),
  Offset(89.143426, 48.472776),
  Offset(89.34263, 48.406375),
  Offset(89.608234, 48.539177),
  Offset(89.807437, 48.472776),
  Offset(91.009863, 48.071967),
  Offset(89.545716, 48.520635),
  Offset(90.305445, 48.14077),
  Offset(90.687664, 47.949661),
  Offset(91.162719, 48.306773),
  Offset(91.467464, 48.306773),
];
